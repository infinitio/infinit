title  UDP forward

note left of Alice: launch 8infinit
Alice->Meta: connect device
note right of Alice:  no public endpoint

note over Apertus: start

note right of Bob: Do all the preparation and starting process
note right of Bob: launch 8infinit
Bob->Meta: connect device
note left of Bob: no public endpoint 

note over Meta: Start Transaction

alt Bob and Alice have no public endpoint
    Meta->Apertus:add_link Alice <-> Bob
    Alice->+Meta: get Bob endpoint
    Meta-->-Alice: Apertus endpoint

    Bob->+Meta: get Alice endpoint
    Meta-->-Bob: Apertus endpoint

    Alice->+Apertus: send traffic
    Apertus->-Bob: send traffic from Alice
    Bob->+Apertus: send traffic
    Apertus->-Alice: send traffic from Bob
else Bob and Alice can connect directly
alt Bob have a full cone NAT or public IP
    Alice->+Meta: get Bob endpoint
    Meta-->-Alice: Bob endpoint

    Alice->Bob:send file
else Alice have a full cone NAT or public IP

    Bob->+Meta: get Alice endpoint
    Meta-->-Bob: Alice endpoint

    Bob->Alice:get file
end
end
